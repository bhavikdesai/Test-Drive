{"status":{},"contains_secrets":false,"product_version":"2.9.1","spec":{"description":"* Access Wordpress from your CentOS_IaaS VM by entering in the HaProxy IP into your browser:\nhttp:\/\/HaProxy_IP","resources":{"client_attrs":{"f272f658_deployment":{"y":-56.7330692143,"x":366.1473316398},"None":{"y":123.8273285227,"x":164.323964902},"5822c37e_deployment":{"y":92.8273285227,"x":677.323964902},"7df0cc1c_deployment":{"y":-56.7330692143,"x":366.1473316398},"4d96f2c3_deployment":{"y":92.8273285227,"x":677.323964902},"83d93222_deployment":{"y":94.9136642614,"x":104.4328750215},"cbc66a9b_deployment":{"y":94.9136642614,"x":104.4328750215}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CreateWordPressDB"}],"name":"614e22c6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateWordPressDB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\n#Create wordpress DB\nmysql -u root -p@@{MYSQL_PASSWORD}@@<<EOF\nCREATE DATABASE wordpress;\nCREATE USER '@@{WP_DB_USER}@@'@'%' IDENTIFIED WITH mysql_native_password BY '@@{WP_DB_PASSWORD}@@';\nGRANT ALL PRIVILEGES ON wordpress.* TO '@@{WP_DB_USER}@@'@'%';\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"55798d8c_runbook","main_task_local_reference":{"kind":"app_task","name":"614e22c6_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7d839765_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"631cf0ea_runbook","main_task_local_reference":{"kind":"app_task","name":"7d839765_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"075e4b33_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"68b3c509_runbook","main_task_local_reference":{"kind":"app_task","name":"075e4b33_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c857778e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"94704c3b_runbook","main_task_local_reference":{"kind":"app_task","name":"c857778e_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e9e7d2d3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"65ac9163_runbook","main_task_local_reference":{"kind":"app_task","name":"e9e7d2d3_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MySQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureWordpress"}],"name":"9807fe1b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureWordpress","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#Get Wordpress installer\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\nwget http:\/\/10.5.1.16\/rpms\/wordpress-latest.tar.gz\ntar -xzf wordpress-latest.tar.gz\nsudo rsync -avP ~\/wordpress\/ \/var\/www\/html\/\nsudo mkdir -p \/var\/www\/html\/wp-content\/uploads\nsudo chown -R apache:apache \/var\/www\/html\/*\n\n# Handle special characters in the passwords\ndb_password='@@{WP_DB_PASSWORD}@@'\ndb_escaped_pass=\"${db_password\/\/\\\/\/\\\\\/}\"\n\n#Configure WP\ncd \/var\/www\/html\ncp wp-config-sample.php wp-config.php\nsed -i \"s\/database_name_here\/wordpress\/g\" wp-config.php\nsed -i \"s\/username_here\/@@{WP_DB_USER}@@\/g\" wp-config.php\nsed -i \"s\/password_here\/$db_escaped_pass\/g\" wp-config.php\nsed -i \"s\/localhost\/@@{MySQL.address}@@\/g\" wp-config.php\n\nsudo chown apache:apache wp-config.php\nsudo systemctl restart httpd\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a992bd98_runbook","main_task_local_reference":{"kind":"app_task","name":"9807fe1b_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d3ab8fc3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4fd20db5_runbook","main_task_local_reference":{"kind":"app_task","name":"d3ab8fc3_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bfc74f9b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e4dbbc0a_runbook","main_task_local_reference":{"kind":"app_task","name":"bfc74f9b_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a5bfd22c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0ecebc2f_runbook","main_task_local_reference":{"kind":"app_task","name":"a5bfd22c_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"208adab8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4e962233_runbook","main_task_local_reference":{"kind":"app_task","name":"208adab8_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"Apache_PHP","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0ffc772f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0b37647d_runbook","main_task_local_reference":{"kind":"app_task","name":"0ffc772f_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"345bfe30_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42c025e9_runbook","main_task_local_reference":{"kind":"app_task","name":"345bfe30_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"8d2423f8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4f6625e7_runbook","main_task_local_reference":{"kind":"app_task","name":"8d2423f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a483ed49_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ac17cd03_runbook","main_task_local_reference":{"kind":"app_task","name":"a483ed49_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9f7ae67d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5bb47e63_runbook","main_task_local_reference":{"kind":"app_task","name":"9f7ae67d_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"Apache_PHP"}],"name":"HaProxy","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"MySQL_Small_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"MySQL-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"Wordpress_Small_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"ApachePHP@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":2048,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HaProxy_Small_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"HaProxy-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":2048,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"MySQL_Large_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"MySQL-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"Wordpress_Large_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"ApachePHP@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HaProxy_Large_AHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"300","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"delay_secs":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"HaProxy-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"default-net","uuid":"3ce36108-fdae-43b1-9dd1-ea65c49f3bf5"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"ea0def4d-5fc8-4af0-a368-ca10ba0d4278","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"AHV_CENTOS_76","uuid":"1bce7c87-e75d-44d0-8fbf-6af65ff86f6c"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CENTOS","editables":{"username":true,"secret":true}}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MySQL_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallMySQL"}],"name":"696811b8_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallMySQL"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallMySQL","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/10.5.1.16\/rpms\/mysql80-community-release-el7.rpm\"\nsudo yum update -y\nsudo yum install -y sshpass mysql-community-server.x86_64\n\necho \"[client]\ndefault-character-set=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n[mysqld]\ncollation-server = utf8_unicode_ci\ncharacter-set-server = utf8\ndefault_authentication_plugin = mysql_native_password\" | sudo tee -a \/etc\/my.cnf\n\nsudo systemctl enable mysqld\nsudo systemctl start mysqld\n\n#Fix to obtain temp password and set it to blank\npassword=$(sudo grep -oP 'temporary password(.*): \\K(\\S+)' \/var\/log\/mysqld.log)\nsudo mysqladmin --user=root --password=\"$password\" password aaBB**cc1122\nsudo mysql --user=root --password=aaBB**cc1122 -e \"UNINSTALL COMPONENT 'file:\/\/component_validate_password'\"\nsudo mysqladmin --user=root --password=\"aaBB**cc1122\" password \"\"\n\n# -*- Mysql secure installation\nmysql -u root<<EOF\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@';\nDELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='';\nDELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';\nFLUSH PRIVILEGES;\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa139f70_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"696811b8_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"9f5b6937_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"add53bd1_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"9f5b6937_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Apache_PHP"}],"name":"Apache_PHP_Package_Small","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Apache_PHP_Package_Small"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallPHP"}],"name":"27550204_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallPHP"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallPHP","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n# -*- Install httpd and php\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\nsudo yum update -y\nsudo rpm -Uvh http:\/\/10.5.1.16\/rpms\/webtatic-release.rpm\nsudo yum -y install http:\/\/10.5.1.16\/rpms\/remi-release-7.rpm\nsudo yum-config-manager --enable remi-php56\nsudo yum install -y httpd php php-mysql php-fpm php-gd wget unzip\n\n\nsudo systemctl enable httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"124852e5_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"27550204_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Apache_PHP_Package_Small"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"11c3b039_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"afe7faff_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"11c3b039_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HaProxy"}],"name":"HaProxy_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HaProxy_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallHaProxy"}],"name":"feefd61c_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallHaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallHaProxy","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\nsudo yum update -y\nsudo yum install -y haproxy\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0f3b1d56_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"feefd61c_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HaProxy_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"b0165015_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"77f817b9_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"b0165015_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"AHV_CENTOS_76","version":"","options":{"type":"","name":"CENTOS_76","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/storage.googleapis.com\/testdrive-templates\/library\/images\/CentOS-7-x86_64-1810.qcow2","version":{"product_version":"","type":"","product_name":""},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MySQL_Package_Large","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallMySQL"}],"name":"696811b8_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallMySQL"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallMySQL","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/10.5.1.16\/rpms\/mysql80-community-release-el7.rpm\"\nsudo yum update -y\nsudo yum install -y sshpass mysql-community-server.x86_64\n\necho \"[client]\ndefault-character-set=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n[mysqld]\ncollation-server = utf8_unicode_ci\ncharacter-set-server = utf8\ndefault_authentication_plugin = mysql_native_password\" | sudo tee -a \/etc\/my.cnf\n\nsudo systemctl enable mysqld\nsudo systemctl start mysqld\n\n#Fix to obtain temp password and set it to blank\npassword=$(sudo grep -oP 'temporary password(.*): \\K(\\S+)' \/var\/log\/mysqld.log)\nsudo mysqladmin --user=root --password=\"$password\" password aaBB**cc1122\nsudo mysql --user=root --password=aaBB**cc1122 -e \"UNINSTALL COMPONENT 'file:\/\/component_validate_password'\"\nsudo mysqladmin --user=root --password=\"aaBB**cc1122\" password \"\"\n\n# -*- Mysql secure installation\nmysql -u root<<EOF\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@';\nDELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='';\nDELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';\nFLUSH PRIVILEGES;\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa139f70_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"696811b8_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"9f5b6937_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"add53bd1_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"9f5b6937_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Apache_PHP"}],"name":"Apache_PHP_Package_Large","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Apache_PHP_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallPHP"}],"name":"27550204_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallPHP"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallPHP","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n# -*- Install httpd and php\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\nsudo yum update -y\nsudo rpm -Uvh http:\/\/10.5.1.16\/rpms\/webtatic-release.rpm\nsudo yum -y install http:\/\/10.5.1.16\/rpms\/remi-release-7.rpm\nsudo yum-config-manager --enable remi-php56\nsudo yum install -y httpd php php-mysql php-fpm php-gd wget unzip\n\n\nsudo systemctl enable httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"124852e5_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"27550204_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Apache_PHP_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"11c3b039_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"afe7faff_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"11c3b039_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HaProxy"}],"name":"HaProxy_Package_Large","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HaProxy_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1ConfYumRepo"},{"kind":"app_task","name":"2InstallHaProxy"}],"name":"feefd61c_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1ConfYumRepo"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2InstallHaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1ConfYumRepo","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm \/etc\/yum.repos.d\/*\n\necho \"[local-base]\nname=CentOS Base\nbaseurl=http:\/\/10.5.1.16\/base\/\ngpgcheck=0\nenabled=1\n\n[local-centosplus]\nname=CentOS CentOSPlus\nbaseurl=http:\/\/10.5.1.16\/centosplus\/\ngpgcheck=0\nenabled=1\n\n[local-extras]\nname=CentOS Extras\nbaseurl=http:\/\/10.5.1.16\/extras\/\ngpgcheck=0\nenabled=1\n\n[local-updates]\nname=CentOS Updates\nbaseurl=http:\/\/10.5.1.16\/updates\/\ngpgcheck=0\nenabled=1\n\n[local-epel]\nname=CentOS Epel\nbaseurl=http:\/\/10.5.1.16\/epel\/\ngpgcheck=0\nenabled=1\" | sudo tee \/etc\/yum.repos.d\/local-repos.repo\n\nsudo yum repolist","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2InstallHaProxy","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\nsudo yum update -y\nsudo yum install -y haproxy\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0f3b1d56_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"feefd61c_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HaProxy_Package_Large"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"b0165015_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"77f817b9_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"b0165015_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"cbc66a9b_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MySQL_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQL_Small_AHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"7df0cc1c_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Apache_PHP_Package_Small"}],"substrate_local_reference":{"kind":"app_substrate","name":"Wordpress_Small_AHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"4d96f2c3_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"HaProxy_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"HaProxy_Small_AHV"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"This action will scale out wordpress app vms by given count","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale Out App"},{"kind":"app_task","name":"Configure HaProxy"}],"name":"788fce62_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Scale Out App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure HaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale Out App","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Configure HaProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\n\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"8a03e7aa_runbook","main_task_local_reference":{"kind":"app_task","name":"788fce62_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":["1","2","3"]}}]},"name":"ScaleOut"},{"description":"This action will scale in wordpress app vms by given count","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale In App"},{"kind":"app_task","name":"Configure HaProxy"}],"name":"51ca4a45_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Scale In App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure HaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale In App","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Configure HaProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\n\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"5f546660_runbook","main_task_local_reference":{"kind":"app_task","name":"51ca4a45_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":["1","2"]}}]},"name":"ScaleIn"},{"description":"This action will temporarily cause application downtime.  Are you sure you want to continue?","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Stop LB"},{"kind":"app_task","name":"Stop App"},{"kind":"app_task","name":"Upgrade LB"},{"kind":"app_task","name":"Upgrade App"},{"kind":"app_task","name":"Stop DB"},{"kind":"app_task","name":"Upgrade DB"},{"kind":"app_task","name":"Start DB"},{"kind":"app_task","name":"Start App"},{"kind":"app_task","name":"Start LB"}],"name":"2eaac87e_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Stop DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade DB"}},{"from_task_reference":{"kind":"app_task","name":"Stop App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade App"}},{"from_task_reference":{"kind":"app_task","name":"Stop LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade LB"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start DB"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start App"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start LB"}},{"from_task_reference":{"kind":"app_task","name":"Stop LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Stop App"}},{"from_task_reference":{"kind":"app_task","name":"Stop App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Stop DB"}},{"from_task_reference":{"kind":"app_task","name":"Start DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start App"}},{"from_task_reference":{"kind":"app_task","name":"Start App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start LB"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop mysqld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start mysqld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"dbce6429_runbook","main_task_local_reference":{"kind":"app_task","name":"2eaac87e_dag"},"variable_list":[]},"name":"Upgrade"}],"name":"Small_AHV","variable_list":[{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"SECRET","name":"MYSQL_PASSWORD","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"WP_DB_USER","value":"wordpress","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"WP_DB_PASSWORD","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false}]},{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"83d93222_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MySQL_Package_Large"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQL_Large_AHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"f272f658_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"6","package_local_reference_list":[{"kind":"app_package","name":"Apache_PHP_Package_Large"}],"substrate_local_reference":{"kind":"app_substrate","name":"Wordpress_Large_AHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"5822c37e_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"HaProxy_Package_Large"}],"substrate_local_reference":{"kind":"app_substrate","name":"HaProxy_Large_AHV"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"This action will scale out wordpress app vms by given count","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale Out App"},{"kind":"app_task","name":"Configure HaProxy"}],"name":"788fce62_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Scale Out App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure HaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f272f658_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale Out App","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Configure HaProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\n\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"8a03e7aa_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"788fce62_dag_cloned_1"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":["1","2","3"]}}]},"name":"ScaleOut"},{"description":"This action will scale in wordpress app vms by given count","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale In App"},{"kind":"app_task","name":"Configure HaProxy"}],"name":"51ca4a45_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Scale In App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure HaProxy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f272f658_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale In App","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Configure HaProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\n\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{Apache_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"5f546660_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"51ca4a45_dag_cloned_1"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":["1","2"]}}]},"name":"ScaleIn"},{"description":"This action will temporarily cause application downtime.  Are you sure you want to continue?","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Stop LB"},{"kind":"app_task","name":"Upgrade LB"},{"kind":"app_task","name":"Stop App"},{"kind":"app_task","name":"Upgrade App"},{"kind":"app_task","name":"Stop DB"},{"kind":"app_task","name":"Upgrade DB"},{"kind":"app_task","name":"Start DB"},{"kind":"app_task","name":"Start App"},{"kind":"app_task","name":"Start LB"}],"name":"64a5ce94_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Stop DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade DB"}},{"from_task_reference":{"kind":"app_task","name":"Stop App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade App"}},{"from_task_reference":{"kind":"app_task","name":"Stop LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Upgrade LB"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start DB"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start App"}},{"from_task_reference":{"kind":"app_task","name":"Upgrade LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start LB"}},{"from_task_reference":{"kind":"app_task","name":"Stop LB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Stop App"}},{"from_task_reference":{"kind":"app_task","name":"Stop App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Stop DB"}},{"from_task_reference":{"kind":"app_task","name":"Start DB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start App"}},{"from_task_reference":{"kind":"app_task","name":"Start App"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Start LB"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl stop mysqld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Upgrade DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex \n\nsudo yum -y upgrade","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start mysqld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Apache_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start App","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HaProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start LB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"b54f8c61_runbook","main_task_local_reference":{"kind":"app_task","name":"64a5ce94_dag"},"variable_list":[]},"name":"Upgrade"}],"name":"Large_AHV","variable_list":[{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"SECRET","name":"MYSQL_PASSWORD","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"WP_DB_USER","value":"wordpress","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"WP_DB_PASSWORD","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"CENTOS"},"type":"USER"},"name":"Wordpress"},"api_version":"3.0","metadata":{"last_update_time":"1585069423322767","kind":"blueprint","spec_version":2,"creation_time":"1585057833353854","categories":{"AppFamily":"DevOps"},"name":"Wordpress"}}